<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Генератор URL для vCard</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 20px auto; padding: 0 15px; }
        h1, h2 { color: #0056b3; }
        form { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        fieldset { border: 1px solid #ccc; border-radius: 8px; padding: 15px; grid-column: 1 / -1; }
        legend { font-weight: bold; color: #333; padding: 0 10px; }
        label { display: block; margin-bottom: 5px; font-weight: 500; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .full-width { grid-column: 1 / -1; }
        #output-container { margin-top: 20px; }
        #generated-url { width: 100%; min-height: 80px; font-family: monospace; font-size: 12px; cursor: pointer; }
        #generated-url:hover { background-color: #f0f8ff; }
        #download-link-container { margin-top: 15px; font-size: 18px; }
        #copy-feedback { color: #28a745; font-weight: bold; margin-left: 10px; transition: opacity 0.5s; }
        .custom-field-row { display: flex; gap: 10px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <h1>Генератор URL для vCard</h1>
    <p>Ссылка будет сгенерирована автоматически. Кликните на поле со ссылкой, чтобы скопировать её.</p>

    <form id="vcard-form" oninput="generateUrl()">
        <fieldset class="full-width">
            <legend>Основная информация</legend>
            <!-- Короткие ID: l, f, m, nn, b, p -->
            <label for="l">Фамилия</label>
            <input type="text" id="l" placeholder="Карнаков" required>
            <label for="f">Имя</label>
            <input type="text" id="f" placeholder="Дмитрий" required>
            <label for="m">Отчество</label>
            <input type="text" id="m" placeholder="Иванович">
            <label for="nn">Псевдоним</label>
            <input type="text" id="nn" placeholder="DK">
            <label for="b">Дата рождения</label>
            <input type="date" id="b">
            <label for="p">URL фотографии</label>
            <input type="url" id="p" placeholder="https://example.com/photo.jpg">
        </fieldset>

        <fieldset class="full-width">
            <legend>Контактная информация</legend>
            <!-- Короткие ID: tc, tw, th, ew, eh, u -->
            <label for="tc">Мобильный телефон</label>
            <input type="tel" id="tc" placeholder="+79123456789">
            <label for="tw">Рабочий телефон</label>
            <input type="tel" id="tw" placeholder="+74951234567">
            <label for="th">Домашний телефон</label>
            <input type="tel" id="th" placeholder="+74998765432">
            <label for="ew">Рабочая почта</label>
            <input type="email" id="ew" placeholder="work@example.com">
            <label for="eh">Личная почта</label>
            <input type="email" id="eh" placeholder="home@example.com">
            <label for="u">Веб-сайт</label>
            <input type="url" id="u" placeholder="https://example.com">
        </fieldset>
        
        <fieldset class="full-width">
            <legend>Работа</legend>
            <!-- Короткие ID: o, t, r -->
            <label for="o">Организация</label>
            <input type="text" id="o" placeholder="ООО 'Пример'">
            <label for="t">Должность</label>
            <input type="text" id="t" placeholder="Инженер">
            <label for="r">Роль</label>
            <input type="text" id="r" placeholder="Разработчик">
        </fieldset>
        
        <fieldset class="full-width">
            <legend>Рабочий адрес</legend>
            <!-- Короткие ID: as, aci, ar, az, aco -->
            <label for="as">Улица, дом</label>
            <input type="text" id="as" placeholder="ул. Ленина, д. 1">
            <label for="aci">Город</label>
            <input type="text" id="aci" placeholder="Москва">
            <label for="ar">Регион/Область</label>
            <input type="text" id="ar" placeholder="Московская область">
            <label for="az">Почтовый индекс</label>
            <input type="text" id="az" placeholder="101000">
            <label for="aco">Страна</label>
            <input type="text" id="aco" placeholder="Россия">
        </fieldset>
        
        <fieldset class="full-width">
            <legend>Дополнительно</legend>
            <!-- Короткий ID: no -->
            <label for="no">Заметка</label>
            <textarea id="no" rows="4" placeholder="Любая дополнительная информация..."></textarea>
        </fieldset>
    </form>

    <div id="output-container" class="full-width" hidden>
        <h2>Результат</h2>
        <label for="generated-url">Сгенерированный URL (кликните, чтобы скопировать): <span id="copy-feedback"></span></label>
        <textarea id="generated-url" readonly onclick="copyUrl()" title="Нажмите, чтобы скопировать"></textarea>
        <div id="download-link-container">
            <a href="#" id="download-link" target="_blank">Перейти по ссылке для генерации и скачивания vCard</a>
        </div>
    </div>

    <script>
        function generateUrl() {
            const form = document.getElementById('vcard-form');
            const params = new URLSearchParams();
            
            // Собираем все поля с ID
            const inputs = form.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                if (input.id && input.value) {
                    params.set(input.id, input.value);
                }
            });

            const queryString = params.toString();
            if (!queryString) {
                document.getElementById('output-container').hidden = true;
                return;
            }
            
            const path = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));
            const baseURL = `${window.location.protocol}//${window.location.host}${path}/vcard.html`;
            const fullURL = `${baseURL}?${queryString}`;

            document.getElementById('generated-url').value = fullURL;
            document.getElementById('download-link').href = fullURL;
            document.getElementById('output-container').hidden = false;
        }

        function copyUrl() {
            const urlText = document.getElementById('generated-url');
            if (!urlText.value) return;

            urlText.select();
            navigator.clipboard.writeText(urlText.value).then(() => {
                const feedback = document.getElementById('copy-feedback');
                feedback.style.opacity = '1';
                feedback.textContent = 'Скопировано!';
                setTimeout(() => { feedback.style.opacity = '0'; }, 2000);
            }).catch(err => console.error('Ошибка копирования: ', err));
        }
        
        // Первый запуск для инициализации
        generateUrl();
    </script>
</body>
</html>
